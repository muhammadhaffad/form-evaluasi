<!DOCTYPE html>
<html lang="id">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Hasil Evaluasi Infrastruktur</title>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  <style>
    :root {
      --primary: #2c5aa0;
      --primary-light: #3a6bc0;
      --secondary: #1e3a5f;
      --accent: #00b4d8;
      --success: #28a745;
      --warning: #ffc107;
      --danger: #dc3545;
      --info: #17a2b8;
      --light: #f8f9fa;
      --dark: #212529;
      --gray-100: #f8f9fa;
      --gray-200: #e9ecef;
      --gray-300: #dee2e6;
      --gray-400: #ced4da;
      --gray-500: #adb5bd;
      --gray-600: #6c757d;
      --gray-700: #495057;
      --gray-800: #343a40;
      --gray-900: #212529;

      --border-radius: 12px;
      --border-radius-sm: 8px;
      --border-radius-lg: 16px;
      --box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
      --box-shadow-lg: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05);
      --transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
    }

    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
      font-family: 'Inter', 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
    }

    body {
      background: linear-gradient(135deg, #f5f7fa 0%, #e4eaf1 100%);
      color: var(--gray-800);
      line-height: 1.6;
      padding: 20px;
      min-height: 100vh;
      font-weight: 400;
    }

    .container {
      max-width: 1400px;
      margin: 0 auto;
    }

    /* Header Styles */
    .page-header {
      background: linear-gradient(135deg, var(--primary) 0%, var(--secondary) 100%);
      border-radius: var(--border-radius-lg);
      box-shadow: var(--box-shadow-lg);
      margin-bottom: 24px;
      padding: 30px;
      color: white;
      position: relative;
      overflow: hidden;
    }

    .page-header::before {
      content: '';
      position: absolute;
      top: 0;
      right: 0;
      width: 200px;
      height: 200px;
      background: rgba(255, 255, 255, 0.1);
      border-radius: 50%;
      transform: translate(30%, -30%);
    }

    .header-content {
      display: flex;
      align-items: center;
      gap: 20px;
      position: relative;
      z-index: 2;
    }

    .header-icon {
      font-size: 3rem;
      color: rgba(255, 255, 255, 0.9);
      background: rgba(255, 255, 255, 0.1);
      padding: 20px;
      border-radius: 50%;
      backdrop-filter: blur(10px);
    }

    .header-text h1 {
      font-size: 2.5rem;
      font-weight: 700;
      margin-bottom: 8px;
      color: white;
    }

    .header-text .description {
      font-size: 1.1rem;
      opacity: 0.9;
      font-weight: 400;
      color: rgba(255, 255, 255, 0.9);
    }

    /* Navigation Menu */
    .navigation-menu {
      background: white;
      border-radius: var(--border-radius);
      box-shadow: var(--box-shadow);
      margin-bottom: 24px;
      padding: 8px;
    }

    .nav-container {
      display: flex;
      gap: 8px;
    }

    .nav-btn {
      flex: 1;
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 12px;
      padding: 16px 24px;
      border: none;
      border-radius: var(--border-radius-sm);
      background: transparent;
      color: var(--gray-600);
      font-size: 1rem;
      font-weight: 600;
      cursor: pointer;
      transition: var(--transition);
      position: relative;
      overflow: hidden;
    }

    .nav-btn::before {
      content: '';
      position: absolute;
      top: 0;
      left: -100%;
      width: 100%;
      height: 100%;
      background: linear-gradient(90deg, transparent, rgba(44, 90, 160, 0.1), transparent);
      transition: left 0.5s;
    }

    .nav-btn:hover::before {
      left: 100%;
    }

    .nav-btn:hover {
      color: var(--primary);
      background: rgba(44, 90, 160, 0.05);
    }

    .nav-btn.active {
      background: var(--primary);
      color: white;
      box-shadow: 0 2px 8px rgba(44, 90, 160, 0.3);
    }

    .nav-btn i {
      font-size: 1.2rem;
    }

    /* Stats Container */
    .stats-container {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(240px, 1fr));
      gap: 20px;
      margin-bottom: 30px;
    }

    .stat-card {
      background: white;
      border-radius: var(--border-radius);
      padding: 25px;
      text-align: center;
      box-shadow: var(--box-shadow);
      transition: var(--transition);
      border-left: 4px solid var(--primary);
    }

    .stat-card:hover {
      transform: translateY(-5px);
      box-shadow: var(--box-shadow-lg);
    }

    .stat-card i {
      font-size: 2.5rem;
      margin-bottom: 15px;
      color: var(--primary);
      background: linear-gradient(135deg, var(--primary) 0%, var(--primary-light) 100%);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
    }

    .stat-value {
      font-size: 2.2rem;
      font-weight: 700;
      color: var(--secondary);
      margin-bottom: 5px;
    }

    .stat-label {
      color: var(--gray-600);
      font-size: 0.95rem;
      font-weight: 500;
    }

    /* Table Container */
    .table-container {
      background: white;
      border-radius: var(--border-radius);
      overflow: hidden;
      box-shadow: var(--box-shadow);
      margin-bottom: 30px;
    }

    table {
      width: 100%;
      border-collapse: collapse;
    }

    thead {
      background: linear-gradient(135deg, var(--primary) 0%, var(--primary-light) 100%);
    }

    th {
      padding: 18px 20px;
      text-align: left;
      font-weight: 600;
      color: white;
      font-size: 0.9rem;
      text-transform: uppercase;
      letter-spacing: 0.5px;
    }

    tbody tr {
      border-bottom: 1px solid var(--gray-200);
      transition: var(--transition);
    }

    tbody tr:hover {
      background: var(--gray-50);
    }

    td {
      padding: 16px 20px;
      color: var(--gray-700);
    }

    /* Action Buttons */
    .actions {
      display: flex;
      justify-content: center;
      gap: 8px;
    }

    .action-btn {
      background: none;
      border: none;
      color: var(--gray-600);
      cursor: pointer;
      font-size: 1.1rem;
      transition: var(--transition);
      padding: 8px;
      border-radius: var(--border-radius-sm);
    }

    .action-btn:hover {
      color: var(--primary);
      background: rgba(44, 90, 160, 0.1);
    }

    .action-btn.view {
      color: var(--primary);
    }

    .action-btn.delete {
      color: var(--danger);
    }

    .action-btn.delete:hover {
      background: rgba(220, 53, 69, 0.1);
    }

    /* Buttons */
    .btn-primary {
      display: inline-flex;
      align-items: center;
      gap: 10px;
      padding: 14px 28px;
      background: linear-gradient(135deg, var(--primary) 0%, var(--primary-light) 100%);
      color: white;
      border: none;
      border-radius: var(--border-radius-sm);
      font-weight: 600;
      cursor: pointer;
      transition: var(--transition);
      box-shadow: var(--box-shadow);
      text-decoration: none;
    }

    .btn-primary:hover {
      transform: translateY(-2px);
      box-shadow: var(--box-shadow-lg);
    }

    /* Footer */
    .footer {
      text-align: center;
      margin-top: 40px;
      color: var(--gray-600);
      font-size: 0.9rem;
      padding: 20px;
    }

    /* Loading State */
    .loading {
      text-align: center;
      padding: 40px;
      color: var(--gray-500);
    }

    .loading i {
      font-size: 2.5rem;
      margin-bottom: 15px;
      color: var(--primary);
    }

    .loading div {
      font-size: 1rem;
      font-weight: 500;
    }

    /* Modal styles */
    .modal {
      display: none;
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background-color: rgba(0, 0, 0, 0.5);
      z-index: 1000;
      justify-content: center;
      align-items: center;
      backdrop-filter: blur(5px);
    }

    .modal-content {
      background-color: white;
      border-radius: var(--border-radius);
      width: 90%;
      max-width: 1000px;
      max-height: 90vh;
      overflow-y: auto;
      box-shadow: var(--box-shadow-lg);
      animation: modalFadeIn 0.3s;
    }

    @keyframes modalFadeIn {
      from {
        opacity: 0;
        transform: translateY(-50px);
      }

      to {
        opacity: 1;
        transform: translateY(0);
      }
    }

    .modal-header {
      padding: 25px 30px;
      background: linear-gradient(135deg, var(--primary) 0%, var(--secondary) 100%);
      color: white;
      border-radius: var(--border-radius) var(--border-radius) 0 0;
      display: flex;
      justify-content: space-between;
      align-items: center;
    }

    .modal-header h2 {
      margin: 0;
      font-size: 1.5rem;
      font-weight: 600;
      display: flex;
      align-items: center;
      gap: 10px;
    }

    .close-btn {
      background: none;
      border: none;
      color: white;
      font-size: 1.5rem;
      cursor: pointer;
      padding: 5px;
      border-radius: 4px;
      transition: var(--transition);
    }

    .close-btn:hover {
      background: rgba(255, 255, 255, 0.2);
    }

    .modal-body {
      padding: 30px;
    }

    .project-info {
      background: var(--gray-100);
      padding: 20px;
      border-radius: var(--border-radius-sm);
      margin-bottom: 25px;
      border-left: 4px solid var(--primary);
    }

    .project-info h3 {
      color: var(--secondary);
      margin-bottom: 8px;
      font-size: 1.3rem;
    }

    .project-info p {
      color: var(--gray-600);
      margin: 0;
    }

    .evaluation-table {
      width: 100%;
      border-collapse: collapse;
      margin-top: 15px;
      box-shadow: var(--box-shadow);
      border-radius: var(--border-radius-sm);
      overflow: hidden;
    }

    .evaluation-table th {
      background: linear-gradient(135deg, var(--secondary) 0%, #152642 100%);
      padding: 16px 20px;
      text-align: left;
      font-weight: 600;
      color: white;
      font-size: 0.85rem;
      text-transform: uppercase;
      letter-spacing: 0.5px;
    }

    .evaluation-table td {
      padding: 14px 20px;
      border-bottom: 1px solid var(--gray-200);
      color: var(--gray-700);
    }

    .evaluation-table tr:last-child td {
      border-bottom: none;
    }

    .evaluation-table tr:hover {
      background: var(--gray-50);
    }

    .evaluation-score {
      font-weight: 600;
      text-align: center;
    }

    .score-excellent {
      color: var(--success);
    }

    .score-good {
      color: var(--primary);
    }

    .score-fair {
      color: var(--warning);
    }

    .score-poor {
      color: var(--danger);
    }

    .summary-card {
      margin-top: 25px;
      padding: 25px;
      background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%);
      border-radius: var(--border-radius);
      border-left: 4px solid var(--primary);
    }

    .summary-card h4 {
      color: var(--secondary);
      margin-bottom: 12px;
      font-size: 1.2rem;
      display: flex;
      align-items: center;
      gap: 8px;
    }

    .summary-card p {
      color: var(--gray-700);
      line-height: 1.7;
      margin-bottom: 15px;
    }

    .total-score {
      font-size: 1.1rem;
      font-weight: 600;
      color: var(--secondary);
    }

    /* Responsive Design */
    @media (max-width: 768px) {
      .stats-container {
        grid-template-columns: 1fr;
      }

      table {
        display: block;
        overflow-x: auto;
      }

      th,
      td {
        padding: 14px 16px;
      }

      .modal-content {
        width: 95%;
        margin: 20px;
      }

      .modal-body {
        padding: 20px;
      }

      .header-content {
        flex-direction: column;
        text-align: center;
        gap: 16px;
      }

      .header-text h1 {
        font-size: 2rem;
      }

      .navigation-menu {
        margin-bottom: 20px;
      }

      .nav-container {
        flex-direction: column;
      }

      .nav-btn {
        padding: 14px 20px;
      }
    }

    @media (max-width: 480px) {
      .page-header {
        padding: 20px 16px;
      }

      .header-icon {
        font-size: 2.5rem;
        padding: 16px;
      }

      .header-text h1 {
        font-size: 1.5rem;
      }

      .actions {
        flex-direction: column;
        gap: 5px;
      }

      .action-btn {
        padding: 6px;
      }
    }
  </style>
</head>

<body>
  <div class="container">
    <header class="page-header">
      <div class="header-content">
        <div class="header-icon">
          <i class="fas fa-chart-line"></i>
        </div>
        <div class="header-text">
          <h1>Hasil Evaluasi Infrastruktur</h1>
          <p class="description">Analisis dan Ringkasan Data Evaluasi Infrastruktur Jawa Timur</p>
        </div>
      </div>
    </header>

    <!-- Menu Navigasi -->
    <nav class="navigation-menu">
      <div class="nav-container">
        <button class="nav-btn" onclick="window.location.href='index.html'">
          <i class="fas fa-clipboard-check"></i>
          <span>Formulir Evaluasi</span>
        </button>
        <button class="nav-btn active" onclick="window.location.href='hasil2.html'">
          <i class="fas fa-chart-bar"></i>
          <span>Hasil Evaluasi</span>
        </button>
      </div>
    </nav>

    <div class="stats-container">
      <div class="stat-card">
        <i class="fas fa-building"></i>
        <div class="stat-value" id="total-projects">0</div>
        <div class="stat-label">Total Proyek</div>
      </div>
      <div class="stat-card">
        <i class="fas fa-map-marker-alt"></i>
        <div class="stat-value" id="total-locations">0</div>
        <div class="stat-label">Lokasi</div>
      </div>

      <div class="stat-card">
        <i class="fas fa-money-bill-wave"></i>
        <div class="stat-value" id="total-value">Rp 0</div>
        <div class="stat-label">Total Nilai Kontrak</div>
      </div>
    </div>

    <div class="table-container">
      <table>
        <thead>
          <tr>
            <th>Nama Infrastruktur</th>
            <th>Lokasi</th>
            <th>Tahun Mulai</th>
            <th>Tahun Selesai</th>
            <th>Nilai Kontrak</th>
            <th>Aksi</th>
          </tr>
        </thead>
        <tbody id="data-table">
          <tr>
            <td colspan="6" class="loading">
              <i class="fas fa-spinner fa-spin"></i>
              <div>Memuat data evaluasi...</div>
            </td>
          </tr>
        </tbody>
      </table>
    </div>

    <div style="text-align: center;">
      <button class="btn-primary" onclick="window.location.href='index.html'">
        <i class="fas fa-arrow-left"></i> Kembali ke Formulir
      </button>
    </div>

    <div class="footer">
      <p>Â© 2024 Sistem Evaluasi Infrastruktur Jawa Timur. Data diperbarui secara real-time.</p>
    </div>
  </div>

  <!-- Modal untuk menampilkan hasil evaluasi -->
  <div id="evaluationModal" class="modal">
    <div class="modal-content">
      <div class="modal-header">
        <h2><i class="fas fa-clipboard-check"></i> Detail Hasil Evaluasi</h2>
        <button class="close-btn" id="closeModal">&times;</button>
      </div>
      <div class="modal-body">
        <div class="project-info">
          <h3 id="project-name">Nama Proyek</h3>
          <p id="project-details">Detail informasi proyek</p>
        </div>
        <table class="evaluation-table">
          <thead>
            <tr>
              <th width="20%">Indikator</th>
              <th width="45%">Sub Indikator</th>
              <th width="35%">Hasil Evaluasi</th>
            </tr>
          </thead>
          <tbody id="evaluation-data">
            <!-- Data evaluasi akan dimasukkan di sini -->
          </tbody>
        </table>
        <div class="summary-card">
          <h4><i class="fas fa-chart-pie"></i> Kesimpulan Evaluasi</h4>
          <p id="evaluation-summary">Ringkasan hasil evaluasi akan ditampilkan di sini.</p>
          <div class="total-score">
            <strong>Total Skor: <span id="total-score">0</span>/100</strong>
          </div>
        </div>
      </div>
    </div>
  </div>

  <script>
    // Fungsi untuk menghitung statistik
    function calculateStats(data) {
      const totalProjects = data.length;
      const locations = [...new Set(data.map(item => item.lokasiInfra))];
      const totalLocations = locations.length;

      const totalYears = data.reduce((sum, item) => sum + parseInt(item.tahunMulai), 0);

      const totalValue = data.reduce((sum, item) => sum + parseInt(item.nilaiKontrak), 0);

      return {
        totalProjects,
        totalLocations,
        totalValue
      };
    }

    // Fungsi untuk memformat nilai mata uang
    function formatCurrency(value) {
      if (value >= 1000000000000) {
        return `Rp ${(value / 1000000000000).toFixed(1)} T`;
      } else if (value >= 1000000000) {
        return `Rp ${(value / 1000000000).toFixed(1)} M`;
      } else if (value >= 1000000) {
        return `Rp ${(value / 1000000).toFixed(1)} Jt`;
      } else {
        return `Rp ${value.toLocaleString("id-ID")}`;
      }
    }

    // Fungsi untuk menampilkan data
    function displayData() {
      fetch("get_data.php")
        .then(res => res.json())
        .then(data => {
          const tbody = document.getElementById("data-table");
          tbody.innerHTML = "";

          if (data.length > 0) {
            data.forEach(row => {
              const tr = document.createElement("tr");
              tr.innerHTML = `
                <td><strong>${row.namaInfra}</strong></td>
                <td>${row.lokasiInfra}</td>
                <td>${row.tahunMulai}</td>
                <td>${row.tahunSelesai}</td>
                <td><strong>${formatCurrency(parseInt(row.nilaiKontrak))}</strong></td>
                <td class="actions">
                  <button class="action-btn view" data-id="${row.id}" title="Lihat Evaluasi">
                    <i class="fas fa-eye"></i>
                  </button>
                  <button class="action-btn download" data-id="${row.id}" title="Download">
                  <i class="fas fa-download"></i>
                  </button>
                  <button class="action-btn delete" data-id="${row.id}" title="Hapus">
                    <i class="fas fa-trash"></i>
                  </button>
                </td>
              `;
              tbody.appendChild(tr);
            });

            // Update statistik
            const stats = calculateStats(data);
            document.getElementById("total-projects").textContent = stats.totalProjects;
            document.getElementById("total-locations").textContent = stats.totalLocations;
            document.getElementById("total-value").textContent = formatCurrency(stats.totalValue);

            // Tambahkan event listener untuk tombol lihat evaluasi
            document.querySelectorAll('.view').forEach(button => {
              button.addEventListener('click', async function () {
                const projectId = this.getAttribute('data-id');
                showEvaluation(projectId);
              });
            });

            // Tambahkan event listener untuk tombol download hasil evaluasi
            document.querySelectorAll('.download').forEach(button => {
              button.addEventListener('click', async function () {
                const projectId = this.getAttribute('data-id');
                downloadEvaluation(projectId);
              });
            });

            // Tambahkan event listener untuk tombol hapus hasil evaluasi
            document.querySelectorAll('.delete').forEach(button => {
              button.addEventListener('click', async function () {
                const projectId = this.getAttribute('data-id');
                deleteEvaluation(projectId);
              });
            });

          } else {
            tbody.innerHTML = `
              <tr>
                <td colspan="6" class="loading">
                  <i class="fas fa-inbox"></i>
                  <div>Belum ada data evaluasi</div>
                </td>
              </tr>
            `;
          }
        })
        .catch(error => {
          console.error('Error fetching data:', error);
          const tbody = document.getElementById("data-table");
          tbody.innerHTML = `
            <tr>
              <td colspan="6" class="loading">
                <i class="fas fa-exclamation-triangle"></i>
                <div>Terjadi kesalahan saat memuat data</div>
              </td>
            </tr>
          `;
        });
    }

    // Fungsi untuk menghapus data evaluasi
    async function downloadEvaluation(projectId) {
      const id = projectId;
      if (id === '') {
        alert('Masukkan ID terlebih dahulu!');
        return;
      }
      // Arahkan ke PHP dengan parameter ID
      window.location.href = `export_excel.php?id=${id}`;

    }

    // Fungsi untuk menghapus data evaluasi
    async function deleteEvaluation(projectId) {
      const id = projectId;
      if (!confirm(`Yakin ingin menghapus data evaluasi ini?`)) {
        return;
      }

      try {
        const response = await fetch('delete_data.php', {
          method: 'POST',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify({ id })
        });

        const result = await response.json();
        alert("Data berhasil dihapus");
        setTimeout(() => {
          displayData();
        }, 500);

      } catch (error) {
        alert("Terjadi kesalahan: " + error);
      }
    }

    // Fungsi untuk menampilkan modal evaluasi
    async function showEvaluation(projectId) {
      const modal = document.getElementById('evaluationModal');

      const response = await fetch(`get_data_by_id.php?id=${projectId}`);
      const data = await response.json();

      const satuData = data;
      console.log(`Data dengan ID ${projectId}:`, satuData);

      if (!satuData) {
        alert('Data evaluasi tidak ditemukan untuk proyek ini.');
        return;
      }

      // Isi informasi proyek
      document.getElementById('project-name').textContent = satuData.namaInfra;
      document.getElementById('project-details').textContent =
        `Lokasi: ${satuData.lokasiInfra} | Tahun: ${satuData.tahunMulai}-${satuData.tahunSelesai} | Nilai Kontrak: ${formatCurrency(parseInt(satuData.nilaiKontrak))}`;

      // Isi tabel evaluasi
      const evaluationTbody = document.getElementById('evaluation-data');
      evaluationTbody.innerHTML = '';

      let totalScore = 0;

      /* section 1 */
      const indikator1 = ["Kondisi Bangunan", "", "", "", ""];
      const subIndikator1 = [
        "Komponen struktur dan arsitektur bangunan dalam kondisi terjaga/sesuai mutu rencana",
        "Seluruh komponen dalam bangunan berfungsi sesuai dengan perencanaan",
        "Bangunan memenuhi persyaratan keselamatan dan kesehatan",
        "Bangunan memenuhi persyaratan kemudahan (akses) dan kenyamanan",
        "Mutu dan kualitas bangunan sesuai dengan perencanaan"];
      const hasilEval1 = [
        satuData.evaluasi1_1, satuData.evaluasi1_2, satuData.evaluasi1_3, satuData.evaluasi1_4, satuData.evaluasi1_5
      ]
      for (let i = 0; i < 5; i++) {
        const tr = document.createElement('tr');
        tr.innerHTML = `
          <td><strong>${indikator1[i]}</strong></td>
          <td>${subIndikator1[i]}</td>
          <td class="evaluation-score">${hasilEval1[i]}</td>
        `;
        evaluationTbody.appendChild(tr);
      }

      /* section 2 */
      const indikator2 = ["Kondisi Jalan Lingkungan", "", "", ""];
      const subIndikator2 = [
        "Ketersediaan jaringan jalan yang mampu melayani aksesibilitas masyarakat sekitar kawasan strategis",
        "Kualitas permukaan jalan sesuai dengan mutu rencana",
        "Kondisi jalan bersih tidak tertutup tanaman liar/rumput yang menutup akses",
        "Kondisi penerangan jalan berfungsi dengan baik"];
      const hasilEval2 = [
        satuData.evaluasi2_1, satuData.evaluasi2_2, satuData.evaluasi2_3, satuData.evaluasi2_4
      ]
      for (let i = 0; i < 4; i++) {
        const tr = document.createElement('tr');
        tr.innerHTML = `
          <td><strong>${indikator2[i]}</strong></td>
          <td>${subIndikator2[i]}</td>
          <td class="evaluation-score">${hasilEval2[i]}</td>
        `;
        evaluationTbody.appendChild(tr);
      }
      /* section 3 */
      const indikator3 = ["Kondisi Drainase Lingkungan", "", "", ""];
      const subIndikator3 = [
        "Kondisi drainase bersih, sehingga dapat mengalirkan limpasan air dan tidak menimbulkan genangan pada jalan",
        "Drainase terhubung dengan sistem drainase perkotaan mengalir dengan baik",
        "Kualitas konstruksi drainase terjaga/sesuai dengan prencanaan",];
      const hasilEval3 = [
        satuData.evaluasi3_1, satuData.evaluasi3_2, satuData.evaluasi3_3
      ]
      for (let i = 0; i < 3; i++) {
        const tr = document.createElement('tr');
        tr.innerHTML = `
          <td><strong>${indikator3[i]}</strong></td>
          <td>${subIndikator3[i]}</td>
          <td class="evaluation-score">${hasilEval3[i]}</td>
        `;
        evaluationTbody.appendChild(tr);
      }
      /* section 4 */
      const indikator4 = ["Sistem penyediaan air minum", "", "", ""];
      const subIndikator4 = [
        "Kondisi prasarana air minum terjaga dan berfungsi",
        "Akses air minum yang mampu melayani kebutuhan penerima manfaat",
        "Kualitas/mutu air yang memenuhi syarat",];
      const hasilEval4 = [
        satuData.evaluasi4_1, satuData.evaluasi4_2, satuData.evaluasi4_3
      ]
      for (let i = 0; i < 3; i++) {
        const tr = document.createElement('tr');
        tr.innerHTML = `
          <td><strong>${indikator4[i]}</strong></td>
          <td>${subIndikator4[i]}</td>
          <td class="evaluation-score">${hasilEval4[i]}</td>
        `;
        evaluationTbody.appendChild(tr);
      }
      /* section 5 */
      const indikator5 = ["Pengelolaan Sampah", "", "", ""];
      const subIndikator5 = [
        "Tersedianya pewadahan/tempat sampah yang difasilitasi dengan sarana pengumpulan dan pengangkutan",
        "Sistem pengelolaan persampahan berfungsi sesuai dengan rencana",
        "Kondisi Prasarana dan Sarana Persampahan yang memenuhi persyaratan teknis",
        "Seluruh area pada kawasan strategis terbangun tidak tercemar sampah"];
      const hasilEval5 = [
        satuData.evaluasi5_1, satuData.evaluasi5_2, satuData.evaluasi5_3, satuData.evaluasi5_4
      ]
      for (let i = 0; i < 4; i++) {
        const tr = document.createElement('tr');
        tr.innerHTML = `
          <td><strong>${indikator5[i]}</strong></td>
          <td>${subIndikator5[i]}</td>
          <td class="evaluation-score">${hasilEval5[i]}</td>
        `;
        evaluationTbody.appendChild(tr);
      }
      /* section 6 */
      const indikator6 = ["Pengelolaan proteksi kebakaran", "", "", ""];
      const subIndikator6 = [
        "Kondisi sarana dan prasarana proteksi kebakaran terpasang dan berfungsi dengan baik",
        "Mutu dan kualitas proteksi kebakaran sesuai dengan perencanaan",];
      const hasilEval6 = [
        satuData.evaluasi6_1, satuData.evaluasi6_2
      ]
      for (let i = 0; i < 2; i++) {
        const tr = document.createElement('tr');
        tr.innerHTML = `
          <td><strong>${indikator6[i]}</strong></td>
          <td>${subIndikator6[i]}</td>
          <td class="evaluation-score">${hasilEval6[i]}</td>
        `;
        evaluationTbody.appendChild(tr);
      }
      /* section 7 */
      const indikator7 = ["Kondisi Ruang Terbuka Hijau/Ruang Terbuka Publik (RTH/RTP)", "", "", ""];
      const subIndikator7 = [
        "RTH/RTP berfungsi dengan baik oleh penerima manfaat",
        "Aksesibilitas pengelolaan RTH/RTP dapat diaksses dengan mudah oleh penerima manfaat",
        "Kondisi area RTH/RTP dapat diakses dengan mudah oleh penerima manfaat",
        "Kualitas RTH/RTP bersih dan tidak terdapat sampah"];
      const hasilEval7 = [
        satuData.evaluasi7_1, satuData.evaluasi7_2, satuData.evaluasi7_3, satuData.evaluasi7_4
      ]
      for (let i = 0; i < 4; i++) {
        const tr = document.createElement('tr');
        tr.innerHTML = `
          <td><strong>${indikator7[i]}</strong></td>
          <td>${subIndikator7[i]}</td>
          <td class="evaluation-score">${hasilEval7[i]}</td>
        `;
        evaluationTbody.appendChild(tr);
      }

      const averageScore = satuData.nilaiAkhir;
      document.getElementById('total-score').textContent = satuData.nilaiAkhir;

      // Tentukan kesimpulan berdasarkan skor rata-rata
      let summary = '';
      if (averageScore >= 76) {
        summary = 'Infrastruktur sangat berfungsi';
      } else if (averageScore >= 51) {
        summary = 'Infrastruktur berfungsi';
      } else if (averageScore >= 26) {
        summary = 'Infrastruktur kurang Berfungsi';
      } else {
        summary = 'Infrastruktur tidak berfungsi';
      }

      document.getElementById('evaluation-summary').textContent = summary;

      // Tampilkan modal
      modal.style.display = 'flex';
    }

    // Event listener untuk menutup modal
    document.getElementById('closeModal').addEventListener('click', function () {
      document.getElementById('evaluationModal').style.display = 'none';
    });

    // Tutup modal ketika mengklik di luar konten modal
    window.addEventListener('click', function (event) {
      const modal = document.getElementById('evaluationModal');
      if (event.target === modal) {
        modal.style.display = 'none';
      }
    });

    // Inisialisasi saat halaman dimuat
    document.addEventListener('DOMContentLoaded', function () {
      setTimeout(() => {
        displayData();
      }, 1000);
    });
  </script>
</body>

</html>